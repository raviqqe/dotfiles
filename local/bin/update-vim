#!/bin/sh

set -e

curl -fLo ~/.config/nvim/autoload/plug.vim --create-dirs \
  https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim

pip3 install --user --upgrade pynvim
gem install neovim
# yarn is for coc extensions.
npm install -g neovim yarn

nvim ${CI:+--headless} +PlugUpgrade +PlugClean! +PlugUpdate +UpdateRemotePlugins +qall
nvim ${CI:+--headless} +'CocInstall -sync coc-clangd coc-go coc-java coc-pyright coc-rust-analyzer coc-spell-checker coc-tabnine coc-tsserver' +qall
nvim ${CI:+--headless} +CocUpdateSync +qall
