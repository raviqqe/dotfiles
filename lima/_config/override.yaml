images:
  - location: https://cloud-images.ubuntu.com/releases/23.04/release/ubuntu-23.04-server-cloudimg-arm64.img
    arch: aarch64
provision:
  - mode: system
    script: |
      #!/bin/bash
      set -ex
      apt update -y --fix-missing
      apt upgrade -y
      apt install -y git libssl-dev pkg-config rcm zsh
      chsh -s /usr/bin/zsh raviqqe
  - mode: user
    script: |
      #!/bin/bash
      set -ex
      if [ ! -r ~/.ssh/*.pub ]; then
        yes '' | ssh-keygen -t ed25519
      fi
      if [ ! -d ~/.dotfiles ]; then
        git clone https://github.com/raviqqe/dotfiles ~/.dotfiles
      fi
      rcup -f
